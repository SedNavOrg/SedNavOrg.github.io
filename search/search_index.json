{"config":{"lang":["fr","en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Contexte du projet","text":"<p>TODO: \u00e9crire le contexte</p>"},{"location":"bibliographie/","title":"Bibliographie","text":"<p>TODO</p>"},{"location":"bom/","title":"Liste du mat\u00e9riel n\u00e9cessaire","text":"<p>TODO: \u00e0 \u00e9crire</p>"},{"location":"ihm/","title":"Interface de contr\u00f4le","text":""},{"location":"ihm/#presentation-du-systeme","title":"Pr\u00e9sentation du syst\u00e8me","text":"<p>L\u2019interface de contr\u00f4le, ou Interface Homme-Machine (IHM) constitue le point central d\u2019interaction entre l\u2019utilisateur et le syst\u00e8me de navigation. Elle permet de visualiser en temps r\u00e9el la position du bateau, le cap, ainsi que les donn\u00e9es issues de l\u2019an\u00e9mom\u00e8tre et du pilote automatique.</p> <p></p> <p>Figure 1. R\u00f4le de l\u2019IHM dans le syst\u00e8me</p> <p>D\u2019un point de vue logiciel, l\u2019IHM repose sur Signal K, qui assure la centralisation et la distribution des donn\u00e9es entre les diff\u00e9rents sous-syst\u00e8mes. OpenCPN agit comme interface graphique principale pour la navigation et le pilotage.</p> <p>Pour la partie mat\u00e9rielle, tout ordinateur compatible avec OpenPlotter peut \u00eatre utilis\u00e9. N\u00e9anmoins, l\u2019ensemble du syst\u00e8me a \u00e9t\u00e9 d\u00e9velopp\u00e9 et valid\u00e9 sur Raspberry Pi 4, configuration que nous recommandons. Un \u00e9cran, un clavier et une souris sont n\u00e9cessaires pour la configuration initiale.</p>"},{"location":"ihm/#montage","title":"Montage","text":""},{"location":"ihm/#installation-dopenplotter","title":"Installation d\u2019OpenPlotter","text":"<p>L\u2019installation d\u2019OpenPlotter n\u00e9cessite un second ordinateur afin de pr\u00e9parer la carte SD. T\u00e9l\u00e9charger l\u2019image officielle d\u2019OpenPlotter depuis le site officiel, puis utiliser un logiciel de flashage tel que Balena Etcher. Ins\u00e9rer la carte SD dans le Raspberry Pi, connecter les p\u00e9riph\u00e9riques (\u00e9cran, clavier, souris), puis d\u00e9marrer le syst\u00e8me. Lors du premier lancement, configurer la langue, le clavier et la connexion internet. Une connexion internet est indispensable pour la suite de l\u2019installation.</p>"},{"location":"ihm/#installation-et-mise-a-jour-des-applications","title":"Installation et mise \u00e0 jour des applications","text":"<p>Allez dans le panneau en haut \u00e0 droite. A moins d\u2019\u00eatre pr\u00e9cis\u00e9 autrement, l\u2019installation des applications sera faite via l\u2019application Settings (accessible depuis le bouton en haut \u00e0 gauche). Dans Settings, cliquer sur Add sources puis sur add candidates. Si \u00e0 un moment ult\u00e9rieur vous avez besoin de mettre \u00e0 jour une application, re-cliquez sur add candidates pour avoir les mises \u00e0 jour.</p> <p></p> <p>Figure 2. Applications disponibles dans OpenPlotter</p>"},{"location":"ihm/#installation-de-signal-k","title":"Installation de Signal K","text":"<p>Dans settings, installez Signal K installer : Une fois cet installer install\u00e9, vous pouvez vous connecter au serveur de Signal K en vous connectant ainsi :  Ouvrir Chromium (ou Firefox) et tapez https://localhost:3000 dans la barre d\u2019adresse. Vous pouvez aussi utiliser ceci, qui le fait pour vous.</p> <p>Une fois connect\u00e9, vous avez une demande pour cr\u00e9er un compte administrateur, Notez les bien quelque part !</p>"},{"location":"ihm/#installation-dopencpn","title":"Installation d\u2019OpenCPN","text":"<p>Comme pr\u00e9c\u00e9demment, installez OpenCPN via settings: Sur l\u2019installer, cliquez sur check versions, puis dans install, s\u00e9lectionnez la version Backport (c\u2019est celle la plus \u00e0 jour)</p> <p></p> <p>Figure 3. Installateur d\u2019OpenCPN</p> <p>Une fois OpenCPN install\u00e9, il faut connecter OpenCPN au serveur Signal K : allez dans Options puis dans Connection et dans la section \u201cconfigure a new connection\u201d, s\u00e9lectionnez network. Comme protocole, choisissez Signal k, comme adresse Localhost et comme port 3000. Laissez l\u2019option automatic server discovery d\u00e9coch\u00e9e (voir figure ci-dessous).</p> <p></p> <p>Figure 4. Connexion entre OpenCPN et Signal K</p> <p>Vous pouvez de plus commencer \u00e0 pr\u00e9parer la connexion au pilote automatique en installant le plugin pypilot.</p>"},{"location":"ihm/#mise-en-place-du-hotspot","title":"Mise en place du Hotspot","text":"<p>Vous avez \u00e0 votre disposition 2 solutions : </p> Installateur automatique (script)Mise en place manuelle <p>Pour installer le hotspot, le point d'acc\u00e8s wifi, vous pouvez utiliser cet installateur : setuphotspot.sh<pre><code>#!/bin/bash\nnmcli dev wifi hotspot ssid opennav password 12345678 band bg channel 6\n</code></pre></p> <ol> <li>Dans le panneau de configuration DU Wifi, en haut \u00e0 droite :    Dans Advanced Options &gt; Create Wireless Hotspot &gt; Create New Wi-Fi Hotspot (photo)   Cr\u00e9er le r\u00e9seau Wifi :   </li> <li>Choisir le nom, le mot de passe (wifi security)  </li> <li>Dans Advanced Options &gt; Edit Connections   </li> <li> <p>S\u00e9lectionner le r\u00e9seau cr\u00e9\u00e9 (photo)</p> </li> <li> <p>S\u00e9lectionner :   </p> </li> <li>Band: B/G (2.4 GHz)  </li> <li>Channel: 6 (2437 MHz)</li> </ol> <p>Arriv\u00e9 ici, nous vous invitons \u00e0 installer le reste des syst\u00e8mes et \u00e0 revenir ici une fois cela fait.</p>"},{"location":"pilote_auto/","title":"Pilote automatique","text":"<p>Le pilote automatique est la partie qui permet de barrer le bateau de mani\u00e8re autonome sans intervention humaine. Cela permet \u00e0 l\u2019utilisateur de tenir un cap ou un angle au vent de mani\u00e8re fiable tout en se reposant ou en faisant autre chose puisque le syst\u00e8me agit sur la barre du bateau.</p> <p>Pour mieux comprendre le fonctionnement du pilote automatique, voici ci-dessous un sch\u00e9ma des composants principaux de celui-ci : </p> <p></p> <p>Figure 1. sch\u00e9ma des composants</p> <p>Le pilote automatique est compos\u00e9 de 3 cartes :</p> <ul> <li>Le compas (qui donne le cap du bateau)  </li> <li>La carte de contr\u00f4le (qui permet de visualiser les param\u00e8tres du pilote automatique)  </li> <li>La carte principale (qui agit sur le v\u00e9rin et qui permet de barrer le bateau)</li> </ul> <p>Voici ci-dessous une photo de l\u2019ensemble de ces trois cartes qui forment le pilote automatique.</p> <p></p> <p>Figure 2. les trois cartes mont\u00e9es</p> <p>Voici un zoom sur les trois cartes s\u00e9par\u00e9ment ainsi que leurs composants : </p> <p></p> <p>Figure 3. Photo du montage du compas</p> <p>D\u00e9tail des composants\u00a0: </p> <ul> <li>ALI\u00a0:\u00a0Amplificateur Lin\u00e9aire Int\u00e9gr\u00e9  </li> <li>R\u00e9sistances\u00a0: r\u00e9duire la tension avant l\u2019ALI pour \u00e9viter la saturation ou pire, la rupture des composants  </li> <li>C\u00e2bles d\u2019alimentation\u00a0: alimenter les composants pr\u00e9sents sur la carte  </li> <li>Acc\u00e9l\u00e9rom\u00e8tre\u00a0: mesurer les flux magn\u00e9tiques que l\u2019on converti par la suite en cap </li> </ul> <p></p> <p>Figure 4. Photo du montage de la carte de contr\u00f4le</p> <p>D\u00e9tail des composants\u00a0: </p> <ul> <li>Ecran de contr\u00f4le\u00a0: afficher les informations n\u00e9cessaires pour configurer et contr\u00f4ler le pilote automatique.  </li> <li>C\u00e2bles d\u2019alimentation\u00a0: alimenter la carte  </li> <li>C\u00e2bles pour transmettre les informations\u00a0: transmettre l\u2019appui sur une touche \u00e0 la carte principale pour que l\u2019Arduino puisse contr\u00f4ler le pilote automatique  </li> <li>Touches de commande\u00a0: commander le pilote avec des touches intuitives et pratiques d\u2019utilisation (les touches sont tactiles)</li> </ul> <p></p> <p>Figure 5. Photo du montage de la carte principale</p> <p>D\u00e9tail des composants\u00a0: </p> <ul> <li>ALI\u00a0:\u00a0Amplificateur Lin\u00e9aire Int\u00e9gr\u00e9  </li> <li>R\u00e9sistances\u00a0: r\u00e9duire la tension pour prot\u00e9ger des composants comme les ALI  </li> <li>C\u00e2bles\u00a0connect\u00e9s \u00e0 la carte de commande\u00a0: faire circuler l\u2019alimentation et les informations de la carte   </li> <li>C\u00e2bles connect\u00e9s au compas\u00a0: idem que pr\u00e9c\u00e9demment mais pour le compas  </li> <li>C\u00e2bles d\u2019alimentation\u00a0: alimenter la carte principale   </li> <li>C\u00e2bles connect\u00e9s au moteur\u00a0: alimenter le moteur et transmettre les informations pour piloter le moteur  </li> <li>Pont IBT2\u00a0: commander le moteur   </li> <li>Arduino Nano\u00a0: piloter le Pont IBT2  </li> <li>Step-down regler\u00a0:\u00a0r\u00e9guler la tension pour alimenter la carte  </li> <li> <p>Raspberry PI0w\u00a0: permettre la communication avec OpenCPN en Wi-Fi</p> </li> <li> <p>Thermor\u00e9sistance : communiquer la temp\u00e9rature du pont pour lancer une alerte en cas de surchauffe</p> </li> <li> </li> </ul> <p>Pour d\u00e9buter le montage du pilote automatique, il faut commencer par la partie hardware. Pour cela, il vous faudra les diff\u00e9rents \u00e9l\u00e9ments de montage (pr\u00e9sents dans la partie : Liste du mat\u00e9riel n\u00e9cessaire, partie pilote automatique). Il vous faudra \u00e9galement les outils suivants : </p> <ul> <li>fer \u00e0 souder (pour les composants \u00e9lectroniques)  </li> <li>tournevis plat de petite taille (pour les composants \u00e9lectroniques)  </li> <li>tournevis cruciforme (pour les composants \u00e9lectroniques)  </li> <li>pince coupante (pour d\u00e9nuder du c\u00e2ble si besoin) </li> </ul> <p>Il n\u2019y a pas vraiment d\u2019ordre de montage des trois cartes, vous pouvez le faire dans l\u2019ordre que vous pr\u00e9f\u00e9rez. Ici, nous avons class\u00e9 les cartes de la plus rapide \u00e0 la plus longue \u00e0 r\u00e9aliser. Pensez seulement \u00e0 mettre correctement tous les composants et les c\u00e2bles et de bien v\u00e9rifier les soudures avant de mettre sous tension sous peine d\u2019endommager certains composants. </p> <p>Recommandations pour les soudures : </p> <ul> <li>Nous vous conseillons d\u2019apprendre \u00e0 souder avant d\u2019essayer de le faire pour le pilote automatique et de vous entra\u00eener  </li> <li> <p>De plus, pour les composants principaux comme la carte arduino, le raspberry, l\u2019acc\u00e9l\u00e9rom\u00e8tre\u2026 nous utilisons : </p> </li> <li> <p>Des connecteurs \u00e0 pics : </p> </li> </ul> <p> </p> <p>Figure 6. connecteurs \u00e0 pics</p> <ul> <li>Des connecteurs \u00e0 trous : </li> </ul> <p> </p> <p>Figure 7. connecteurs \u00e0 trous</p> <ul> <li>Connecteurs de bornier : </li> </ul> <p> </p> <p>Figure 8. connecteurs de bornier</p> <p>Cela permet de ne pas souder directement les composants sur la carte et donc de pouvoir les remplacer plus facilement en cas de dysfonctionnement. </p> <ol> <li> </li> </ol> <p>Pour rappel, le compas est l\u2019outil qui permet de conna\u00eetre le cap du bateau et de communiquer cette information avec la carte principale pour que le pilote automatique corrige le cap. Voici l\u2019objectif final du montage :   </p> <p> </p> <p>Figure 9. compas</p> <p>Il vous faut souder les composants suivants : </p> Emplacement sur la carte Composant Caract\u00e9ristiques J1 4 connecteurs de bornier Aucunes R1, R2 R\u00e9sistance 430 \ud835\udec0 R3, R4 R\u00e9sistance 4,7 k\ud835\udec0 U1 2x4 connecteurs \u00e0 trous I2C extender (passerelle I2C en fran\u00e7ais) Attention aux pattes, elles sont tr\u00e8s fragiles Aucunes P82B715 + Sockel U2 1x4 connecteurs \u00e0 pics Acc\u00e9l\u00e9rom\u00e8tre Aucunes MPU 9250 oder 9255 ou IMU 9250 oder 9255 ICM20948 (actuellement) <p>Remarques :</p> <ul> <li>Pour trouver les bonnes valeurs de r\u00e9sistance et le syst\u00e8me utilis\u00e9 voici une image explicative :  </li> </ul> <p>Figure 10. sch\u00e9ma_explicatif:positron libre</p> <ul> <li>Les r\u00e9sistances n\u2019ont pas de sens, vous pouvez mettre la patte gauche \u00e0 droite ou bien \u00e0 gauche, cela ne changera en rien le fonctionnement de la r\u00e9sistance.  </li> <li>Le I2C extender par contre a un sens et il faut \u00eatre vigilant. Il faut v\u00e9rifier la documentation en fonctions des composants mais voici notre montage comme indication : </li> </ul> <p> </p> <p>Figure 11. sens du I2C</p> <p>On remarque le le point noir donne le sens, ici il est du c\u00f4t\u00e9 de l\u2019arrondi pr\u00e9sent en dessous de U1</p> <ul> <li> <p>Pour les quatre fils, il n\u2019y a pas d\u2019ordre non plus. Il faut juste que le fil branch\u00e9 au GND sur cette carte soit \u00e9galement branch\u00e9 au GND sur la carte principale (le montage sera d\u00e9taill\u00e9 dans la partie 6.2.1.3) et de m\u00eame pour les 3 autres fils. De mani\u00e8re g\u00e9n\u00e9rale dans les montages \u00e9lectriques et \u00e9lectroniques, les couleurs n\u2019ont pas vraiment d\u2019importance sauf pour le noir qui concerne les fils reli\u00e9s \u00e0 la masse et donc GND (ground) en anglais mais vous \u00eates bien entendus libres de mettre les couleurs que vous pr\u00e9f\u00e9rez.</p> </li> <li> </li> </ul> <p>Pour rappel, la carte de contr\u00f4le permet de contr\u00f4ler le pilote automatique sans l\u2019IHM, de mani\u00e8re ind\u00e9pendante. L\u2019\u00e9cran sert \u00e0 afficher les diff\u00e9rents menus et le cap du compas (172 dans la figure ci-dessous). Les boutons permettent de naviguer dans les menus et de modifier les param\u00e8tres pour param\u00e9trer le pilote automatique.</p> <p>Voici l\u2019objectif final du montage : </p> <p> </p> <p>Figure 12. face recto de la carte de contr\u00f4le</p> <p> </p> <p>Figure 13. face verso de la carte de contr\u00f4le</p> <p>Pour cela, il vous faudra souder les composants suivants : </p> Emplacement sur la carte Composant Caract\u00e9ristiques J1 1x7 connecteurs de bornier sur le verso Aucunes J2 1x8 connecteurs de bornier sur le verso Aucunes R1 R\u00e9sistance 2,5 k\ud835\udec0 U3 1x8 Connecteurs \u00e0 broches Ecran LCD Aucunes Jlx12864 U1-U2,U4-U8 8x1x3 connecteurs \u00e0 trous Touches tactiles Aucunes TP223 <p>M\u00eames remarques que pr\u00e9c\u00e9demment concernant les couleurs des fils et leur emplacement. </p> <p>De plus, comme les touches sont tactiles, nous vous conseillons de mettre des supports pour supporter les touches et \u00e9viter qu\u2019elles ne s'ab\u00eement au fur et \u00e0 mesure qu\u2019on les manipule. </p> <p> </p> <p>Figure 14. supports</p> <p>Vous pouvez imprimer en 3D des cylindres (\u2300 : 6 mm, hauteur : 9 mm), avant de le coller ou bien mettre des pions en bois. Le tout est de mettre un mat\u00e9riau isolant pour supporter les touches en porte \u00e0 faux et \u00e9viter de les ab\u00eemer.</p> <ol> <li> </li> </ol> <p>La carte principale est celle qui centralise les informations et qui permet de contr\u00f4ler la barre. De plus, le raspberry assure la communication avec l\u2019IHM et permet donc l\u2019\u00e9change d\u2019informations entre celui-ci et le pilote automatique. Voici le montage final :   </p> <p> </p> <p>Figure 15. carte principale</p> <p>Et voici une image pour voir les soudures en d\u00e9tails : </p> <p> </p> <p>Figure 16. soudures carte principale</p> <p>Pour cela il vous faudra souder les composants suivants : </p> Emplacement sur la carte Composant Caract\u00e9ristiques J1, J2, J3, J5, J7, J8 Connecteurs de bornier Aucunes J6 2x4 connecteurs \u00e0 pics Aucunes R1, R2 R\u00e9sistances 430 \ud835\udec0 R3, R4, R12 R\u00e9sistances 4,7 k\ud835\udec0 R5 R\u00e9sistance 10 k\ud835\udec0 R6 R\u00e9sistance 5,6 k\ud835\udec0 R7, R8 R\u00e9sistances 120 k\ud835\udec0 R9, R10 R\u00e9sistances 47 k\ud835\udec0 R11, R13 R\u00e9sistances 22 k\ud835\udec0 TH1 Thermor\u00e9sistance 4,7 k\ud835\udec0 U1 2x4 connecteurs \u00e0 trous I2C Extender Attention aux pattes, elles sont tr\u00e8s fragiles Aucunes P82B715 + Sockel U2, U3 2x2x7 connecteurs \u00e0 trous Inverter Attention aux pattes, elles sont tr\u00e8s fragiles Aucunes Inverter 74HCT04 + Sockel U4 2x20 connecteurs \u00e0 trous Raspberry Pi Zero W Aucunes U5 Vis \u00e9crou de support Pont IBT2 4 c\u00e2bles entre le pont et la carte (en rouge sur la figure \u2026) Aucunes U6 4x1 connecteurs \u00e0 pics Step-Down Regler Aucunes LM2596 4-35V A1 2x15 connecteurs \u00e0 trous Arduino Nano Aucunes <p>Remarques : </p> <ul> <li>Pour la thermor\u00e9sistance, une fois les soudures termin\u00e9es et valid\u00e9es, vous pouvez installer le pont IBT2 et la thermistance avec de la p\u00e2te thermique entre les deux. Vous pouvez bien \u00e9videmment le faire quand vous le souhaitez mais il est plus simple de le faire une fois que vous n\u2019aurez plus \u00e0 manipuler la carte  </li> <li>Pour le Step-Down Regler, il vaut mieux le calibrer sur 5V avant utilisation  </li> <li>M\u00eame remarque pour le I2C extender que pour le compas concernant le sens de pose  </li> <li>Les Inverter ont un sens et il faut \u00eatre vigilant. Il faut v\u00e9rifier la documentation en fonctions des composants mais voici notre montage comme indication :</li> </ul> <p> </p> <p>Figure 17. sens des inverter</p> <ul> <li>Pour les diff\u00e9rents c\u00e2bles, vous devez brancher les m\u00eames c\u00e2bles que ceux des cartes pr\u00e9c\u00e9dentes. Par exemple, le c\u00e2ble GND du compas doit \u00eatre branch\u00e9 sur l\u2019emplacement GND r\u00e9serv\u00e9 au compas sur la carte. Voici une figure illustrant les diff\u00e9rentes parties r\u00e9serv\u00e9es pour les cartes :     ![][image17] Figure 57 : emplacement r\u00e9serv\u00e9es de la carte </li> </ul> <p>De gauche \u00e0 droite : </p> Emplacement sur la carte Port Caract\u00e9ristiques J2 Stb10 -10\u00b0 sur le cap demand\u00e9 J2 Stb1 -1\u00b0 sur le cap demand\u00e9 J2 Port1 +1\u00b0 sur le cap demand\u00e9 J2 Port10 +10\u00b0 sur le cap demand\u00e9 J2 Tack Touche Tack J2 Select Touche Select J2 Menue Touche Menu J2 Auto Touche Auto J1 DIN DIN pour l\u2019\u00e9cran J1 CLK Clock pour l\u2019\u00e9cran J1 RST Reset pour pour l\u2019\u00e9cran J1 DC DC pour l\u2019\u00e9cran J1 CE CE pour l\u2019\u00e9cran J1 3.3V+ +3.3V pour l\u2019\u00e9cran J1 3.3V- -3.3V pour l\u2019\u00e9cran J3 3.3V+ +3.3V pour le compas J3 3.3V- -3.3V pour le compas J3 SDA SDA pour le compas J3 SCL SCL pour le compas J7 5V- -5V pour potentiom\u00e8tre J7 Sense retour du potentiom\u00e8tre J7 5V+ +5V pour potentiom\u00e8tre J5 12V- +12V alimentation J5 12V+ -12V alimentation J5 SeaT Connexion non utilis\u00e9e par pypilot J5 - alimentation du moteur J5 + alimentation du moteur J5 12V+ alimentation du v\u00e9rin J5 12V- alimentation du v\u00e9rin J5 SeaT Connexion non utilis\u00e9e par pypilot J8 Motor - alimentation du moteur J8 Motor + alimentation du moteur J8 12V- alimentation du v\u00e9rin J8 12V+ alimentation du v\u00e9rin <p>Remarques:</p> <ul> <li>Sur J5, les connexions : in 12V, In12+ et In Seat sont connect\u00e9es directement sur le PCB respectivement \u00e0 Out 12V-, Out12+ et Out Seat.</li> </ul>"},{"location":"pilote_auto/#presentation-du-systeme","title":"Pr\u00e9sentation du syst\u00e8me","text":""},{"location":"pilote_auto/#montage","title":"Montage","text":""},{"location":"pilote_auto/#partie-hardware","title":"Partie Hardware","text":""},{"location":"pilote_auto/#compas","title":"Compas","text":""},{"location":"pilote_auto/#carte-de-controle","title":"Carte de contr\u00f4le","text":""},{"location":"pilote_auto/#carte-principale","title":"Carte principale","text":""},{"location":"pilote_auto/#_1","title":"Pilote automatique","text":"<p>Pour ce qui est de la partie software, tous les codes proviennent de Github et peuvent y \u00eatre t\u00e9l\u00e9charg\u00e9s. Liens \u00e0 ajouter Le mat\u00e9riel n\u00e9cessaire pour effectuer tout cela, est le suivant : </p> <ul> <li>un c\u00e2ble USB type A - Micro USB pour alimenter le Raspberry Pi Zero et faire quelques tests  </li> <li>un c\u00e2ble USB type A - Mini USB type B pour alimenter la carte Arduino Nano et t\u00e9l\u00e9verser les codes dessus  </li> <li>un lecteur de carte SD  </li> <li> <p>une carte SD d\u2019au moins 2 GB</p> </li> <li> </li> </ul> <p>Dans ce passage nous d\u00e9taillons le processus de connexion du pilote automatique \u00e0 l\u2019IHM. Cela permettra de centraliser les informations et de pouvoir contr\u00f4ler le pilote automatique sur l\u2019\u00e9cran principal. Vous devez d\u00e9j\u00e0 avoir t\u00e9l\u00e9charg\u00e9 pypilot sur l\u2019IHM (partie 4.4). Le Raspberry Pi a le r\u00f4le d\u2019ordinateur pour le pilote automatique, c\u2019est lui qui transf\u00e8re les informations au programme OpenCPN et qui g\u00e8re les diff\u00e9rentes informations re\u00e7ues dans le pilote automatique en g\u00e9n\u00e9ral (affichage sur l\u2019\u00e9cran LCD, donn\u00e9es du compas, \u2026). Il faut donc \u201cflasher\u201d le programme de base de cet ordinateur, qui est sous la forme d\u2019une image sur la carte SD du Raspberry Pi.</p> <p>Pour cela : </p> <ul> <li>T\u00e9l\u00e9chargez la derni\u00e8re version de Tinypilot sur leur site : https://pypilot.org/downloads/ </li> <li>D\u00e9compressez l\u2019archive qui a \u00e9t\u00e9 t\u00e9l\u00e9charg\u00e9e, \u00e7a sera l\u2019image \u00e0 transf\u00e9rer  </li> <li>Pour flasher l\u2019image sur la carte SD, installez le logiciel raspberry Pi imager : https://www.raspberrypi.com/software/ </li> <li>Une fois le logiciel install\u00e9 et les instructions de mise en route suivies, vous pouvez flasher l\u2019image  </li> <li>S\u00e9lectionnez le mod\u00e8le de raspberry (ici le Raspberry Pi 0 W)  </li> <li>S\u00e9lectionnez ensuite l\u2019utilisation d\u2019une image personnalis\u00e9e comme OS, et allez chercher celle que vous venez de t\u00e9l\u00e9charger  </li> <li>Vous pouvez maintenant choisir le stockage que vous souhaitez utiliser, et lancer l\u2019\u00e9criture</li> </ul> <p>Une fois que vous avez flash\u00e9 l\u2019image, ins\u00e9rez la carte SD dans le Raspberry PI Zero, puis Attendez ensuite une minute le temps que le Raspberry se lance correctement. Maintenant connectez-vous au r\u00e9seau wifi \u201cpypilot\u201d qui devrait appara\u00eetre dans les r\u00e9seaux disponibles, il n\u2019y a pas besoin de mot de passe.</p> <p>Ensuite dans votre navigateur, entrez l\u2019adresse IP suivante dans la barre d\u2019adresse : 192.168.14.1 Cela devrait vous amener sur cette page du pilote automatique (remarque la langue et la couleur du fond peuvent \u00eatre modifi\u00e9e et donc diff\u00e9rentes sur votre pilote automatique) :  ![][image18] Figure 58 : page d\u2019accueil pilote automatique</p> <p>Cette page web est essentielle car elle permet d'acc\u00e9der \u00e0 tous les param\u00e8tres du pilote automatique depuis un \u00e9cran plus grand que l\u2019\u00e9cran LCD.  En effet, si vous utilisez le pilote automatique de mani\u00e8re autonome, vous pouvez acc\u00e9der \u00e0 toutes les donn\u00e9es et les param\u00e8tres sur cette page web (ce sont les m\u00eames menus que ceux afficher sur l\u2019\u00e9cran LCD). Ainsi pour les calibrations futures, vous pourrez passer par l\u2019\u00e9cran ou par ce site directement selon vos pr\u00e9f\u00e9rences.  Allez dans l\u2019onglet \u201cConfiguration\u201d, puis cliquez sur le lien \u201cConfigure Wifi\u201d, vous devez obtenir la page suivante : </p> <p>Figure 18. page de configuration Wifi</p> <p>On observe ici le point d\u2019acc\u00e8s qui a \u00e9t\u00e9 cr\u00e9\u00e9 ainsi que notre PC qui est connect\u00e9 au r\u00e9seau (c\u2019est l\u2019adresse IP 192.168.14.109) </p> <p>Il faut ensuite changer l\u2019onglet de Master (AP) \u00e0 Manage (client) cela signifie que le raspberry passe de manager du r\u00e9seau \u00e0 client et nous allons le configurer pour \u00eatre Client du r\u00e9seau cr\u00e9\u00e9 par l\u2019IHM comme sur la figure suivante :  </p> <p>Figure 19. configuration client</p> <p>Compl\u00e9tez les champs suivants : </p> <ul> <li>SSID par celui configur\u00e9 dans l\u2019IHM (attention aux majuscules, il faut bien mettre exactement le m\u00eame nom)   </li> <li>Client Cl\u00e9 par le code renseign\u00e9 dans l\u2019IHM (partie 4.2.5)  </li> <li>adresse du mode client avec une adresse IP compatible avec celles configur\u00e9es dans l\u2019IHM (partie 4.2.5) et notez l\u2019adresse IP, on en aura besoin plus tard</li> </ul> <p>Puis cliquez sur Submit, d\u00e9branchez la carte du PC avant de la rebrancher sur la carte principale pour \u201creboot\u201d la carte et valider l\u2019op\u00e9ration. Dans OpenCPN (sur l\u2019IHM) lancez le plugin pypilot et cliquez sur AP comme sur la figure suivante : </p> <p> </p> <p>Figure 20. connexion pypilot</p> <p>Ensuite, entrez dans l\u2019onglet Settings et noter l\u2019adresse IP (celle configur\u00e9e quelques lignes plus t\u00f4t) dans la barre comme sur la figure suivante : </p> <p> </p> <p>Figure 21. connexion r\u00e9ussie</p> <p>Vous devriez avoir le bandeau vert apr\u00e8s quelques secondes signifiant une r\u00e9ussite de l\u2019op\u00e9ration. Si ce n\u2019est pas le cas, il se peut que vous ayez fait une des erreurs suivantes : </p> <ul> <li>Probl\u00e8me de carte SD du raspberry PI  </li> <li>Mauvaise adresse IP  </li> <li>Mauvaise configuration de pypilot  </li> <li>Mauvaise configuration du point d\u2019acc\u00e8s de l\u2019IHM (partie 4.2.5)</li> </ul> <p>Reprenez les \u00e9tapes pr\u00e9c\u00e9dentes ou renseignez vous sur le forum en cas de probl\u00e8me.</p> <p>Une fois valid\u00e9, vous pouvez observer le message : Connect\u00e9 \u00e0 OpenCPN sur l\u2019\u00e9cran LCD du pilote automatique dans le menu : settings -&gt; control -&gt; Wifi et les informations pr\u00e9alablement renseign\u00e9es. Ceci clos la connexion entre le pilote automatique et l\u2019IHM, maintenant toutes les informations trouvables sur le site web ou sur l\u2019\u00e9cran LCD se retrouve sur l\u2019IHM (notamment le cap du compas et le cap d\u00e9sir\u00e9).</p> <ol> <li> </li> </ol> <p>La carte arduino Nano a pour r\u00f4le d\u2019envoyer les commandes au moteur en fonction des donn\u00e9es re\u00e7ues par le compas. Pour cela, il faut lui donner le programme qu\u2019elle devra suivre. Afin de t\u00e9l\u00e9verser ce programme, vous pouvez t\u00e9l\u00e9charger l\u2019IDE Arduino depuis leur page web, et suivre les \u00e9tapes d\u2019initialisation : https://www.arduino.cc/en/software/ Une fois que le logiciel est install\u00e9, vous pouvez t\u00e9l\u00e9charger le programme \u00e0 t\u00e9l\u00e9verser sur github, ainsi que les biblioth\u00e8ques n\u00e9cessaires :  Lien temporaire pour les fichiers :  https://drive.google.com/file/d/1sLZdqL6ufFpdVWxDVSjmh9KC6vfXsYSw/view?usp=drive_link</p> <p>Une fois que vous avez t\u00e9l\u00e9charg\u00e9 cette archive zip, vous pouvez la d\u00e9compresser et mettre tous les fichiers dans le m\u00eame dossier de votre ordinateur, puis renommer ce dossier \u201cpypilotmotorcontrollerwithrudder\u201d Vous pouvez maintenant ouvrir le fichier en .ino qui se trouve dans ce dossier avec le logiciel Arduino IDE V\u00e9rifier s\u2019il faut ouvrir un workspace ou bien si le fichier .ino suffit</p> <p>Vous pouvez maintenant connecter la carte arduino \u00e0 votre ordinateur, choisir le mod\u00e8le \u201cArduino Nano\u201d dans Tools-&gt;Board-&gt;Arduino Nano, puis choisir le bon port dans Tools-&gt;Port (Pour conna\u00eetre le bon port, il suffit de tester l\u2019\u00e9tape suivante et si elle renvoie une erreur, essayez avec un autre choix)</p> <p>Vous pouvez maintenant t\u00e9l\u00e9verser le programme en cliquant sur le bouton avec la fl\u00e8che vers la droite.  </p>"},{"location":"pilote_auto/#partie-software","title":"Partie Software","text":""},{"location":"pilote_auto/#raspberry-pi-zero","title":"Raspberry Pi Zero","text":""},{"location":"pilote_auto/#arduino-nano","title":"Arduino Nano","text":""},{"location":"systeme_complet/","title":"Pr\u00e9sentation du syst\u00e8me complet","text":"<p>TODO: \u00e9crire le syst\u00e8me final</p>"},{"location":"an%C3%A9mom%C3%A8tre/","title":"An\u00e9mom\u00e8tre","text":"<p>TODO: \u00e9crire la partie an\u00e9mom\u00e8tre</p>"}]}